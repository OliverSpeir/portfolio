<!DOCTYPE html><html data-astro-cid-7jjqptxk="" data-critters-container="" lang="en"><head><style>:where(img){height:auto}</style><meta charset="UTF-8"><meta content="width=device-width" name="viewport"><meta content="This blog post explains how to create a NextAuth SocialSignOn button that connects to a Django REST Framework API" name="description"><link href="/favicon.svg" rel="icon" type="image/svg"><link href="/profile_picture_small.png" rel="apple-touch-icon"><link href="/sitemap-index.xml" rel="sitemap"><meta content="This blog post explains how to create a NextAuth SocialSignOn button that connects to a Django REST Framework API" property="og:description"><meta content="../../imgs/DRF-NextAuth-Logo.png" property="og:image"><meta content="www.oliverspeir.com/nextauth-with-drf" property="og:url"><meta content="../../imgs/DRF-NextAuth-Logo.png" name="twitter:card"><meta content="NextAuth with DRF" property="og:title"><title>NextAuth with DRF</title><!-- <Meta/> --><script>document.addEventListener("DOMContentLoaded",e=>{let t=document.querySelectorAll("pre");t.forEach(e=>{let t=`<svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 stroke-white" fill="none" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 7.5V6.108c0-1.135.845-2.098 1.976-2.192.373-.03.748-.057 1.123-.08M15.75 18H18a2.25 2.25 0 002.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 00-1.123-.08M15.75 18.75v-1.875a3.375 3.375 0 00-3.375-3.375h-1.5a1.125 1.125 0 01-1.125-1.125v-1.5A3.375 3.375 0 006.375 7.5H5.25m11.9-3.664A2.251 2.251 0 0015 2.25h-1.5a2.251 2.251 0 00-2.15 1.586m5.8 0c.065.21.1.433.1.664v.75h-6V4.5c0-.231.035-.454.1-.664M6.75 7.5H4.875c-.621 0-1.125.504-1.125 1.125v12c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V16.5a9 9 0 00-9-9z" />
                          </svg>`,o=`<svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 stroke-white" fill="none" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M11.35 3.836c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 00.75-.75 2.25 2.25 0 00-.1-.664m-5.8 0A2.251 2.251 0 0113.5 2.25H15c1.012 0 1.867.668 2.15 1.586m-5.8 0c-.376.023-.75.05-1.124.08C9.095 4.01 8.25 4.973 8.25 6.108V8.25m8.9-4.414c.376.023.75.05 1.124.08 1.131.094 1.976 1.057 1.976 2.192V16.5A2.25 2.25 0 0118 18.75h-2.25m-7.5-10.5H4.875c-.621 0-1.125.504-1.125 1.125v11.25c0 .621.504 1.125 1.125 1.125h9.75c.621 0 1.125-.504 1.125-1.125V18.75m-7.5-10.5h6.375c.621 0 1.125.504 1.125 1.125v9.375m-8.25-3l1.5 1.5 3-3.75" />
                </svg>`,n=document.createElement("div");n.className="relative group";let a=document.createElement("button");a.innerHTML=t,a.className="copy-code-button bg-transparent absolute top-1 right-1 z-10 opacity-0 group-hover:opacity-100 transition-opacity",a.setAttribute("aria-label","Copy code to clipboard"),a.addEventListener("click",()=>{let n=e.innerText;navigator.clipboard.writeText(n),a.innerHTML=o,setTimeout(()=>{a.innerHTML=t},2e3)}),e.parentNode.insertBefore(n,e),n.appendChild(e),n.appendChild(a)})});</script><title>NextAuth-with-DRF</title><meta content="true" name="astro-view-transitions-enabled"><meta content="animate" name="astro-view-transitions-fallback"><style type="text/css">a[data-astro-cid-4ducenwb]{text-decoration:none}a[data-astro-cid-4ducenwb].link{color:#5973f7;font-size:x-large}nav[data-astro-cid-4ducenwb].links{justify-content:center;gap:1rem;display:flex}@media (width<=874px){nav[data-astro-cid-4ducenwb].links{gap:.5rem}}*,:before,:after{box-sizing:border-box;border:0 solid #e5e7eb}:before,:after{--tw-content:""}html{-webkit-text-size-adjust:100%;-moz-tab-size:4;-o-tab-size:4;tab-size:4;font-feature-settings:normal;font-variation-settings:normal;font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;line-height:1.5}body{line-height:inherit;margin:0}h1,h2,h3,h4{font-size:inherit;font-weight:inherit}a{color:inherit;text-decoration:inherit}code,pre{font-family:ui-monospace,SFMono-Regular,Menlo,Monaco,Consolas,Liberation Mono,Courier New,monospace;font-size:1em}button{font-feature-settings:inherit;font-variation-settings:inherit;font-family:inherit;font-size:100%;font-weight:inherit;line-height:inherit;color:inherit;text-transform:none;-webkit-appearance:button;background-color:#0000;background-image:none;margin:0;padding:0}h1,h2,h3,h4,p,pre{margin:0}ol,ul{margin:0;padding:0;list-style:none}button{cursor:pointer}img,svg{vertical-align:middle;display:block}img{max-width:100%;height:auto}:root{background-color:hsl(var(--b1)/var(--tw-bg-opacity,1));color:hsl(var(--bc)/var(--tw-text-opacity,1))}html{-webkit-tap-highlight-color:transparent}:root{color-scheme:light;--pf:259 94% 44%;--sf:314 100% 40%;--af:174 75% 39%;--nf:214 20% 14%;--in:198 93% 60%;--su:158 64% 52%;--wa:43 96% 56%;--er:0 91% 71%;--inc:198 100% 12%;--suc:158 100% 10%;--wac:43 100% 11%;--erc:0 100% 14%;--rounded-box:1rem;--rounded-btn:.5rem;--rounded-badge:1.9rem;--animation-btn:.25s;--animation-input:.2s;--btn-text-case:uppercase;--btn-focus-scale:.95;--border-btn:1px;--tab-border:1px;--tab-radius:.5rem;--p:259 94% 51%;--pc:259 96% 91%;--s:314 100% 47%;--sc:314 100% 91%;--a:174 75% 46%;--ac:174 75% 11%;--n:214 20% 21%;--nc:212 19% 87%;--b1:0 0% 100%;--b2:0 0% 95%;--b3:180 2% 90%;--bc:215 28% 17%}@media (prefers-color-scheme:dark){:root{color-scheme:dark;--pf:262 80% 43%;--sf:316 70% 43%;--af:175 70% 34%;--in:198 93% 60%;--su:158 64% 52%;--wa:43 96% 56%;--er:0 91% 71%;--inc:198 100% 12%;--suc:158 100% 10%;--wac:43 100% 11%;--erc:0 100% 14%;--rounded-box:1rem;--rounded-btn:.5rem;--rounded-badge:1.9rem;--animation-btn:.25s;--animation-input:.2s;--btn-text-case:uppercase;--btn-focus-scale:.95;--border-btn:1px;--tab-border:1px;--tab-radius:.5rem;--p:262 80% 50%;--pc:0 0% 100%;--s:316 70% 50%;--sc:0 0% 100%;--a:175 70% 41%;--ac:0 0% 100%;--n:213 18% 20%;--nf:212 17% 17%;--nc:220 13% 69%;--b1:212 18% 14%;--b2:213 18% 12%;--b3:213 18% 10%;--bc:220 13% 69%}}*,:before,:after{--tw-border-spacing-x:0;--tw-border-spacing-y:0;--tw-translate-x:0;--tw-translate-y:0;--tw-rotate:0;--tw-skew-x:0;--tw-skew-y:0;--tw-scale-x:1;--tw-scale-y:1;--tw-pan-x: ;--tw-pan-y: ;--tw-pinch-zoom: ;--tw-scroll-snap-strictness:proximity;--tw-gradient-from-position: ;--tw-gradient-via-position: ;--tw-gradient-to-position: ;--tw-ordinal: ;--tw-slashed-zero: ;--tw-numeric-figure: ;--tw-numeric-spacing: ;--tw-numeric-fraction: ;--tw-ring-inset: ;--tw-ring-offset-width:0px;--tw-ring-offset-color:#fff;--tw-ring-color:#3b82f680;--tw-ring-offset-shadow:0 0 #0000;--tw-ring-shadow:0 0 #0000;--tw-shadow:0 0 #0000;--tw-shadow-colored:0 0 #0000;--tw-blur: ;--tw-brightness: ;--tw-contrast: ;--tw-grayscale: ;--tw-hue-rotate: ;--tw-invert: ;--tw-saturate: ;--tw-sepia: ;--tw-drop-shadow: ;--tw-backdrop-blur: ;--tw-backdrop-brightness: ;--tw-backdrop-contrast: ;--tw-backdrop-grayscale: ;--tw-backdrop-hue-rotate: ;--tw-backdrop-invert: ;--tw-backdrop-opacity: ;--tw-backdrop-saturate: ;--tw-backdrop-sepia: }.prose{color:var(--tw-prose-body);max-width:65ch}.prose :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em}.prose :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-links);font-weight:500;text-decoration:underline}.prose :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em;padding-left:1.625em;list-style-type:decimal}.prose :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em;margin-bottom:1.25em;padding-left:1.625em;list-style-type:disc}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-counters);font-weight:400}.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:var(--tw-prose-bullets)}.prose :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:0;margin-bottom:.888889em;font-size:2.25em;font-weight:800;line-height:1.11111}.prose :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:2em;margin-bottom:1em;font-size:1.5em;font-weight:700;line-height:1.33333}.prose :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.6em;margin-bottom:.6em;font-size:1.25em;font-weight:600;line-height:1.6}.prose :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-headings);margin-top:1.5em;margin-bottom:.5em;font-weight:600;line-height:1.5}.prose :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-code);font-size:.875em;font-weight:600}.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:"`"}.prose :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){color:var(--tw-prose-pre-code);background-color:var(--tw-prose-pre-bg);border-radius:.375rem;margin-top:1.71429em;margin-bottom:1.71429em;padding:.857143em 1.14286em;font-size:.875em;font-weight:400;line-height:1.71429;overflow-x:auto}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)){font-weight:inherit;color:inherit;font-size:inherit;font-family:inherit;line-height:inherit;background-color:#0000;border-width:0;border-radius:0;padding:0}.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):before,.prose :where(pre code):not(:where([class~=not-prose],[class~=not-prose] *)):after{content:none}.prose{--tw-prose-body:#374151;--tw-prose-headings:#111827;--tw-prose-lead:#4b5563;--tw-prose-links:#111827;--tw-prose-bold:#111827;--tw-prose-counters:#6b7280;--tw-prose-bullets:#d1d5db;--tw-prose-hr:#e5e7eb;--tw-prose-quotes:#111827;--tw-prose-quote-borders:#e5e7eb;--tw-prose-captions:#6b7280;--tw-prose-kbd:#111827;--tw-prose-kbd-shadows:17 24 39;--tw-prose-code:#111827;--tw-prose-pre-code:#e5e7eb;--tw-prose-pre-bg:#1f2937;--tw-prose-th-borders:#d1d5db;--tw-prose-td-borders:#e5e7eb;--tw-prose-invert-body:#d1d5db;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#9ca3af;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#9ca3af;--tw-prose-invert-bullets:#4b5563;--tw-prose-invert-hr:#374151;--tw-prose-invert-quotes:#f3f4f6;--tw-prose-invert-quote-borders:#374151;--tw-prose-invert-captions:#9ca3af;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d1d5db;--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:#4b5563;--tw-prose-invert-td-borders:#374151;font-size:1rem;line-height:1.75}.prose :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.5em;margin-bottom:.5em}.prose :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.375em}.prose :where(.prose>ul>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ul>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(.prose>ol>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.25em}.prose :where(.prose>ol>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.25em}.prose :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.75em;margin-bottom:.75em}.prose :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)),.prose :where(.prose>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose :where(.prose>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}.prose-zinc{--tw-prose-body:#3f3f46;--tw-prose-headings:#18181b;--tw-prose-lead:#52525b;--tw-prose-links:#18181b;--tw-prose-bold:#18181b;--tw-prose-counters:#71717a;--tw-prose-bullets:#d4d4d8;--tw-prose-hr:#e4e4e7;--tw-prose-quotes:#18181b;--tw-prose-quote-borders:#e4e4e7;--tw-prose-captions:#71717a;--tw-prose-kbd:#18181b;--tw-prose-kbd-shadows:24 24 27;--tw-prose-code:#18181b;--tw-prose-pre-code:#e4e4e7;--tw-prose-pre-bg:#27272a;--tw-prose-th-borders:#d4d4d8;--tw-prose-td-borders:#e4e4e7;--tw-prose-invert-body:#d4d4d8;--tw-prose-invert-headings:#fff;--tw-prose-invert-lead:#a1a1aa;--tw-prose-invert-links:#fff;--tw-prose-invert-bold:#fff;--tw-prose-invert-counters:#a1a1aa;--tw-prose-invert-bullets:#52525b;--tw-prose-invert-hr:#3f3f46;--tw-prose-invert-quotes:#f4f4f5;--tw-prose-invert-quote-borders:#3f3f46;--tw-prose-invert-captions:#a1a1aa;--tw-prose-invert-kbd:#fff;--tw-prose-invert-kbd-shadows:255 255 255;--tw-prose-invert-code:#fff;--tw-prose-invert-pre-code:#d4d4d8;--tw-prose-invert-pre-bg:#00000080;--tw-prose-invert-th-borders:#52525b;--tw-prose-invert-td-borders:#3f3f46}@media (hover:hover){.menu li>:not(ul):not(.menu-title):not(details):active{--tw-bg-opacity:1;background-color:hsl(var(--n)/var(--tw-bg-opacity));--tw-text-opacity:1;color:hsl(var(--nc)/var(--tw-text-opacity))}}.btn{cursor:pointer;-webkit-user-select:none;-moz-user-select:none;user-select:none;border-color:#0000;border-color:hsl(var(--b2)/var(--tw-border-opacity));text-align:center;border-radius:var(--rounded-btn,.5rem);border-width:var(--border-btn,1px);animation:button-pop var(--animation-btn,.25s)ease-out;text-transform:var(--btn-text-case,uppercase);--tw-border-opacity:1;--tw-bg-opacity:1;background-color:hsl(var(--b2)/var(--tw-bg-opacity));--tw-text-opacity:1;color:hsl(var(--bc)/var(--tw-text-opacity));outline-color:hsl(var(--bc)/1);flex-wrap:wrap;flex-shrink:0;justify-content:center;align-items:center;gap:.5rem;height:3rem;min-height:3rem;padding-left:1rem;padding-right:1rem;font-size:.875rem;font-weight:600;line-height:1em;text-decoration-line:none;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-duration:.2s;transition-timing-function:cubic-bezier(0,0,.2,1);display:inline-flex}.btn:disabled{pointer-events:none}.dropdown{display:inline-block;position:relative}.dropdown>:focus{outline-offset:2px;outline:2px solid #0000}.dropdown .dropdown-content{position:absolute}.dropdown:not(details) .dropdown-content{visibility:hidden;opacity:0;transform-origin:top;--tw-scale-x:.95;--tw-scale-y:.95;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y));transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-duration:.2s;transition-timing-function:cubic-bezier(0,0,.2,1)}.dropdown-end .dropdown-content{right:0}.dropdown-top .dropdown-content{transform-origin:bottom;top:auto;bottom:100%}.dropdown:not(.dropdown-hover):focus .dropdown-content,.dropdown:focus-within .dropdown-content{visibility:visible;opacity:1}@media (hover:hover){.btn:hover{--tw-border-opacity:1;border-color:hsl(var(--b3)/var(--tw-border-opacity));--tw-bg-opacity:1;background-color:hsl(var(--b3)/var(--tw-bg-opacity))}.btn:disabled:hover{--tw-border-opacity:0;background-color:hsl(var(--n)/var(--tw-bg-opacity));--tw-bg-opacity:.2;color:hsl(var(--bc)/var(--tw-text-opacity));--tw-text-opacity:.2}:where(.menu li:not(.menu-title):not(.disabled)>:not(ul):not(details):not(.menu-title)):not(.active):hover{cursor:pointer;background-color:hsl(var(--bc)/.1);--tw-text-opacity:1;color:hsl(var(--bc)/var(--tw-text-opacity));outline-offset:2px;outline:2px solid #0000}}.link{cursor:pointer;text-decoration-line:underline}.menu{flex-flow:column wrap;padding:.5rem;font-size:.875rem;line-height:1.25rem;display:flex}.menu :where(li:not(.menu-title)>:not(ul):not(details):not(.menu-title)){-webkit-user-select:none;-moz-user-select:none;user-select:none;grid-auto-columns:minmax(auto,max-content) auto max-content;grid-auto-flow:column;align-content:flex-start;align-items:center;gap:.5rem;display:grid}:where(.menu li){flex-flow:column wrap;flex-shrink:0;align-items:stretch;display:flex;position:relative}.btn:active:hover,.btn:active:focus{transform:scale(var(--btn-focus-scale,.97));animation:ease-out button-pop}.btn:focus-visible{outline-offset:2px;outline-width:2px;outline-style:solid}.btn:disabled{--tw-border-opacity:0;background-color:hsl(var(--n)/var(--tw-bg-opacity));--tw-bg-opacity:.2;color:hsl(var(--bc)/var(--tw-text-opacity));--tw-text-opacity:.2}@keyframes button-pop{0%{transform:scale(var(--btn-focus-scale,.98))}40%{transform:scale(1.02)}to{transform:scale(1)}}.dropdown:focus .dropdown-content,.dropdown:focus-within .dropdown-content{--tw-scale-x:1;--tw-scale-y:1;transform:translate(var(--tw-translate-x),var(--tw-translate-y))rotate(var(--tw-rotate))skew(var(--tw-skew-x))skewY(var(--tw-skew-y))scaleX(var(--tw-scale-x))scaleY(var(--tw-scale-y))}.link:focus{outline-offset:2px;outline:2px solid #0000}.link:focus-visible{outline-offset:2px;outline:2px solid}:where(.menu li:empty){background-color:hsl(var(--bc)/.1);height:1px;margin:.5rem 1rem}.menu :where(li:not(.menu-title)>:not(ul):not(details):not(.menu-title)){text-align:left;border-radius:var(--rounded-btn,.5rem);text-wrap:balance;padding:.5rem 1rem;transition-property:color,background-color,border-color,text-decoration-color,fill,stroke,opacity,box-shadow,transform,filter,backdrop-filter,-webkit-backdrop-filter;transition-duration:.2s;transition-timing-function:cubic-bezier(0,0,.2,1)}:where(.menu li:not(.menu-title):not(.disabled)>:not(ul):not(details):not(.menu-title)):not(summary):not(.active):focus{cursor:pointer;background-color:hsl(var(--bc)/.1);--tw-text-opacity:1;color:hsl(var(--bc)/var(--tw-text-opacity));outline-offset:2px;outline:2px solid #0000}.menu li>:not(ul):not(.menu-title):not(details):active{--tw-bg-opacity:1;background-color:hsl(var(--n)/var(--tw-bg-opacity));--tw-text-opacity:1;color:hsl(var(--nc)/var(--tw-text-opacity))}:root .prose{--tw-prose-body:hsl(var(--bc)/.8);--tw-prose-headings:hsl(var(--bc));--tw-prose-lead:hsl(var(--bc));--tw-prose-links:hsl(var(--bc));--tw-prose-bold:hsl(var(--bc));--tw-prose-counters:hsl(var(--bc));--tw-prose-bullets:hsl(var(--bc)/.5);--tw-prose-hr:hsl(var(--bc)/.2);--tw-prose-quotes:hsl(var(--bc));--tw-prose-quote-borders:hsl(var(--bc)/.2);--tw-prose-captions:hsl(var(--bc)/.5);--tw-prose-code:hsl(var(--bc));--tw-prose-pre-code:hsl(var(--nc));--tw-prose-pre-bg:hsl(var(--n));--tw-prose-th-borders:hsl(var(--bc)/.5);--tw-prose-td-borders:hsl(var(--bc)/.2)}.prose :where(code):not(:where([class~=not-prose] *)){border-radius:var(--rounded-badge);padding:2px 8px}.prose code:after,.prose code:before{content:none}.prose pre code{border-radius:0;padding:0}.rounded-box{border-radius:var(--rounded-box,1rem)}.tooltip{--tooltip-offset:calc(100% + 1px + var(--tooltip-tail,0px));display:inline-block;position:relative}.tooltip:before{pointer-events:none;z-index:1;content:var(--tw-content);--tw-content:attr(data-tip);top:auto;left:50%;right:auto;bottom:var(--tooltip-offset);position:absolute;transform:translate(-50%)}.tooltip{text-align:center;--tooltip-tail:.1875rem;--tooltip-color:hsl(var(--n));--tooltip-text-color:hsl(var(--nc));--tooltip-tail-offset:calc(100% + .0625rem - var(--tooltip-tail));display:inline-block;position:relative}.tooltip:before,.tooltip:after{opacity:0;transition:color .2s cubic-bezier(.4,0,.2,1) .1s,background-color .2s cubic-bezier(.4,0,.2,1) .1s,border-color .2s cubic-bezier(.4,0,.2,1) .1s,text-decoration-color .2s cubic-bezier(.4,0,.2,1) .1s,fill .2s cubic-bezier(.4,0,.2,1) .1s,stroke .2s cubic-bezier(.4,0,.2,1) .1s,opacity .2s cubic-bezier(.4,0,.2,1) .1s,box-shadow .2s cubic-bezier(.4,0,.2,1) .1s,transform .2s cubic-bezier(.4,0,.2,1) .1s,filter .2s cubic-bezier(.4,0,.2,1) .1s,backdrop-filter .2s cubic-bezier(.4,0,.2,1) .1s,-webkit-backdrop-filter .2s cubic-bezier(.4,0,.2,1) .1s}.tooltip:after{content:"";border-style:solid;border-width:var(--tooltip-tail,0);width:0;height:0;display:block;position:absolute}.tooltip:before{background-color:var(--tooltip-color);color:var(--tooltip-text-color);border-radius:.25rem;width:max-content;max-width:20rem;padding:.25rem .5rem;font-size:.875rem;line-height:1.25rem}.tooltip:hover:before,.tooltip:hover:after{opacity:1;transition-delay:75ms}.tooltip:not([data-tip]):hover:before,.tooltip:not([data-tip]):hover:after{visibility:hidden;opacity:0}.tooltip:after{border-color:var(--tooltip-color)transparent transparent transparent;top:auto;left:50%;right:auto;bottom:var(--tooltip-tail-offset);transform:translate(-50%)}article.prose :is(h1,h2,h3,h4,h5,h6){align-items:center;gap:.5rem;display:flex}.anchor-link{margin-top:.25rem}.sr-only{clip:rect(0,0,0,0);white-space:nowrap;border-width:0;width:1px;height:1px;margin:-1px;padding:0;position:absolute;overflow:hidden}.fixed{position:fixed}.bottom-0{bottom:0}.left-0{left:0}.right-0{right:0}.right-4{right:1rem}.top-10{top:2.5rem}.z-10{z-index:10}.z-50{z-index:50}.z-\[1\]{z-index:1}.m-1{margin:.25rem}.mx-auto{margin-left:auto;margin-right:auto}.-mb-\[\.35rem\]{margin-bottom:-.35rem}.-ml-2{margin-left:-.5rem}.-ml-7{margin-left:-1.75rem}.-mt-1{margin-top:-.25rem}.-mt-2{margin-top:-.5rem}.-mt-5{margin-top:-1.25rem}.-mt-\[\.15rem\]{margin-top:-.15rem}.-mt-\[\.3rem\]{margin-top:-.3rem}.mb-0{margin-bottom:0}.mb-1{margin-bottom:.25rem}.mb-16{margin-bottom:4rem}.mb-2{margin-bottom:.5rem}.ml-2{margin-left:.5rem}.mr-2{margin-right:.5rem}.mt-0{margin-top:0}.flex{display:flex}.hidden{display:none}.h-full{height:100%}.max-h-52{max-height:13rem}.max-h-80{max-height:20rem}.min-h-screen{min-height:100vh}.w-48{width:12rem}.min-w-0{min-width:0}.max-w-\[10rem\]{max-width:10rem}.max-w-max{max-width:max-content}.list-none{list-style-type:none}.justify-end{justify-content:flex-end}.overflow-y-auto{overflow-y:auto}.overflow-x-hidden{overflow-x:hidden}.break-words{overflow-wrap:break-word}.rounded-lg{border-radius:.5rem}.border{border-width:1px}.border-zinc-400{--tw-border-opacity:1;border-color:rgb(161 161 170/var(--tw-border-opacity))}.bg-transparent{background-color:#0000}.bg-zinc-100{--tw-bg-opacity:1;background-color:rgb(244 244 245/var(--tw-bg-opacity))}.bg-zinc-300{--tw-bg-opacity:1;background-color:rgb(212 212 216/var(--tw-bg-opacity))}.p-2{padding:.5rem}.p-4{padding:1rem}.pb-14{padding-bottom:3.5rem}.pb-2{padding-bottom:.5rem}.pt-10{padding-top:2.5rem}.text-left{text-align:left}.text-2xl{font-size:1.5rem;line-height:2rem}.text-3xl{font-size:1.875rem;line-height:2.25rem}.text-black{--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.text-blue-600{--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity))}.text-zinc-950{--tw-text-opacity:1;color:rgb(9 9 11/var(--tw-text-opacity))}.shadow{--tw-shadow:0 1px 3px 0 #0000001a,0 1px 2px -1px #0000001a;--tw-shadow-colored:0 1px 3px 0 var(--tw-shadow-color),0 1px 2px -1px var(--tw-shadow-color);box-shadow:var(--tw-ring-offset-shadow,0 0 #0000),var(--tw-ring-shadow,0 0 #0000),var(--tw-shadow)}.sidebar::-webkit-scrollbar-track{margin-top:5px;margin-bottom:5px}.sidebar::-webkit-scrollbar{background:#a1a1aa1a;border-top-right-radius:20px;border-bottom-right-radius:20px;width:5px}.sidebar::-webkit-scrollbar-thumb{background-color:#a1a1aa;border-radius:.5rem}pre::-webkit-scrollbar{background:#dbdbdb33;border-bottom-right-radius:20px;border-bottom-left-radius:20px;height:8px}pre::-webkit-scrollbar-thumb{background-color:#a1a1aa;border-radius:.5rem}.bottombar::-webkit-scrollbar{width:5px}.bottombar::-webkit-scrollbar-track{background:linear-gradient(#0000 0% 1%,#a1a1aa33 1% 99%,#0000 99% 100%);margin-top:10px;margin-bottom:15px}.bottombar::-webkit-scrollbar-thumb{background-color:#a1a1aa;border-radius:.5rem}@media (prefers-color-scheme:dark){pre{background-color:#18181b!important}pre code span{background-color:#18181b}}@media (prefers-color-scheme:light){pre code span{background-color:#2b3440}}.maxwidth{max-width:10rem}@media (width>=768px){.md\:prose-lg{font-size:1.125rem;line-height:1.77778}.md\:prose-lg :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.33333em;margin-bottom:1.33333em}.md\:prose-lg :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:.833333em;font-size:2.66667em;line-height:1}.md\:prose-lg :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.86667em;margin-bottom:1.06667em;font-size:1.66667em;line-height:1.33333}.md\:prose-lg :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.66667em;margin-bottom:.666667em;font-size:1.33333em;line-height:1.5}.md\:prose-lg :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.77778em;margin-bottom:.444444em;line-height:1.55556}.md\:prose-lg :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.77778em;margin-bottom:1.77778em}.md\:prose-lg :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.888889em}.md\:prose-lg :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.375rem;margin-top:2em;margin-bottom:2em;padding:1em 1.5em;font-size:.888889em;line-height:1.75}.md\:prose-lg :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)),.md\:prose-lg :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.33333em;margin-bottom:1.33333em;padding-left:1.55556em}.md\:prose-lg :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.666667em;margin-bottom:.666667em}.md\:prose-lg :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)),.md\:prose-lg :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.444444em}.md\:prose-lg :where(.md\:prose-lg>ul>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.33333em}.md\:prose-lg :where(.md\:prose-lg>ul>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.33333em}.md\:prose-lg :where(.md\:prose-lg>ol>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.33333em}.md\:prose-lg :where(.md\:prose-lg>ol>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.33333em}.md\:prose-lg :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.888889em;margin-bottom:.888889em}.md\:prose-lg :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)),.md\:prose-lg :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)),.md\:prose-lg :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)),.md\:prose-lg :where(.md\:prose-lg>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.md\:prose-lg :where(.md\:prose-lg>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}}@media (width>=1024px){.lg\:prose-xl{font-size:1.25rem;line-height:1.8}.lg\:prose-xl :where(p):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.2em;margin-bottom:1.2em}.lg\:prose-xl :where(h1):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:.857143em;font-size:2.8em;line-height:1}.lg\:prose-xl :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.55556em;margin-bottom:.888889em;font-size:1.8em;line-height:1.11111}.lg\:prose-xl :where(h3):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.6em;margin-bottom:.666667em;font-size:1.5em;line-height:1.33333}.lg\:prose-xl :where(h4):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.8em;margin-bottom:.6em;line-height:1.6}.lg\:prose-xl :where(img):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:2em;margin-bottom:2em}.lg\:prose-xl :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){font-size:.9em}.lg\:prose-xl :where(pre):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.5rem;margin-top:2em;margin-bottom:2em;padding:1.11111em 1.33333em;font-size:.9em;line-height:1.77778}.lg\:prose-xl :where(ol):not(:where([class~=not-prose],[class~=not-prose] *)),.lg\:prose-xl :where(ul):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.2em;margin-bottom:1.2em;padding-left:1.6em}.lg\:prose-xl :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.6em;margin-bottom:.6em}.lg\:prose-xl :where(ol>li):not(:where([class~=not-prose],[class~=not-prose] *)),.lg\:prose-xl :where(ul>li):not(:where([class~=not-prose],[class~=not-prose] *)){padding-left:.4em}.lg\:prose-xl :where(.lg\:prose-xl>ul>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.2em}.lg\:prose-xl :where(.lg\:prose-xl>ul>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.2em}.lg\:prose-xl :where(.lg\:prose-xl>ol>li>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:1.2em}.lg\:prose-xl :where(.lg\:prose-xl>ol>li>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:1.2em}.lg\:prose-xl :where(ul ul,ul ol,ol ul,ol ol):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:.8em;margin-bottom:.8em}.lg\:prose-xl :where(h2+*):not(:where([class~=not-prose],[class~=not-prose] *)),.lg\:prose-xl :where(h3+*):not(:where([class~=not-prose],[class~=not-prose] *)),.lg\:prose-xl :where(h4+*):not(:where([class~=not-prose],[class~=not-prose] *)),.lg\:prose-xl :where(.lg\:prose-xl>:first-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.lg\:prose-xl :where(.lg\:prose-xl>:last-child):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:0}}.hover\:border-zinc-500:hover{--tw-border-opacity:1;border-color:rgb(113 113 122/var(--tw-border-opacity))}.hover\:bg-zinc-400:hover{--tw-bg-opacity:1;background-color:rgb(161 161 170/var(--tw-bg-opacity))}.hover\:text-blue-900:hover{--tw-text-opacity:1;color:rgb(30 58 138/var(--tw-text-opacity))}.prose-headings\:text-black :where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.prose-h2\:mb-2 :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){margin-bottom:.5rem}.prose-h2\:mt-0 :where(h2):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0}.prose-a\:text-blue-600 :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity))}.hover\:prose-a\:text-blue-900 :where(a):not(:where([class~=not-prose],[class~=not-prose] *)):hover{--tw-text-opacity:1;color:rgb(30 58 138/var(--tw-text-opacity))}.prose-code\:rounded-md :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){border-radius:.375rem}.prose-code\:bg-zinc-300 :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-bg-opacity:1;background-color:rgb(212 212 216/var(--tw-bg-opacity))}.prose-code\:text-black :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(0 0 0/var(--tw-text-opacity))}.prose-li\:my-0 :where(li):not(:where([class~=not-prose],[class~=not-prose] *)){margin-top:0;margin-bottom:0}.prose-li\:marker\:text-black * :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#000}.prose-li\:marker\:text-zinc-950 * :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#09090b}.prose-li\:marker\:text-black :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#000}.prose-li\:marker\:text-zinc-950 :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#09090b}@media (prefers-color-scheme:dark){.dark\:border-zinc-800{--tw-border-opacity:1;border-color:rgb(39 39 42/var(--tw-border-opacity))}.dark\:bg-zinc-700{--tw-bg-opacity:1;background-color:rgb(63 63 70/var(--tw-bg-opacity))}.dark\:bg-zinc-800{--tw-bg-opacity:1;background-color:rgb(39 39 42/var(--tw-bg-opacity))}.dark\:text-blue-400{--tw-text-opacity:1;color:rgb(96 165 250/var(--tw-text-opacity))}.dark\:text-white{--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.dark\:text-zinc-100{--tw-text-opacity:1;color:rgb(244 244 245/var(--tw-text-opacity))}.dark\:hover\:text-blue-600:hover{--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity))}.dark\:prose-headings\:text-white :where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(255 255 255/var(--tw-text-opacity))}.dark\:prose-headings\:text-zinc-100 :where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(244 244 245/var(--tw-text-opacity))}.dark\:prose-headings\:text-zinc-50 :where(h1,h2,h3,h4,h5,h6,th):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(250 250 250/var(--tw-text-opacity))}.dark\:prose-a\:text-blue-400 :where(a):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-text-opacity:1;color:rgb(96 165 250/var(--tw-text-opacity))}.dark\:hover\:prose-a\:text-blue-600 :where(a):not(:where([class~=not-prose],[class~=not-prose] *)):hover{--tw-text-opacity:1;color:rgb(37 99 235/var(--tw-text-opacity))}.dark\:prose-code\:bg-zinc-400 :where(code):not(:where([class~=not-prose],[class~=not-prose] *)){--tw-bg-opacity:1;background-color:rgb(161 161 170/var(--tw-bg-opacity))}.dark\:prose-li\:marker\:text-white * :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#fff}.dark\:prose-li\:marker\:text-zinc-100 * :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#f4f4f5}.dark\:prose-li\:marker\:text-white :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#fff}.dark\:prose-li\:marker\:text-zinc-100 :where(li):not(:where([class~=not-prose],[class~=not-prose] *))::marker{color:#f4f4f5}}@media (width>=1150px){.xl\:block{display:block}.xl\:hidden{display:none}}body{--tw-bg-opacity:1;background-color:rgb(244 244 245/var(--tw-bg-opacity))}@media (prefers-color-scheme:dark){body{--tw-bg-opacity:1;background-color:rgb(39 39 42/var(--tw-bg-opacity))}}.tooltip[data-astro-cid-bpcqfiqj]:after{content:attr(data-tooltip);background:var(--card-color);color:var(--text-color);z-index:1;white-space:nowrap;opacity:0;pointer-events:none;border-radius:20px;padding:0 10px 5px;transition:opacity .5s ease-in-out;position:absolute;top:100%;left:50%;transform:translate(-50%)}.tooltip[data-astro-cid-bpcqfiqj]{display:inline-block;position:relative}.tooltip[data-astro-cid-bpcqfiqj]:hover:after{opacity:1}.projects[data-astro-cid-bpcqfiqj] svg[data-astro-cid-bpcqfiqj]{width:auto;height:3rem}@media (width<=874px){.projects[data-astro-cid-bpcqfiqj]{justify-content:center;gap:1rem;display:flex;overflow:hidden}.projects[data-astro-cid-bpcqfiqj] svg[data-astro-cid-bpcqfiqj]{width:auto;height:3rem}}@media (width>=875px){.projects[data-astro-cid-bpcqfiqj]{justify-content:center;gap:1rem;margin-right:.5rem;display:flex;overflow:visible}.projects[data-astro-cid-bpcqfiqj] svg[data-astro-cid-bpcqfiqj]{width:auto;height:3rem}}.cls-1{fill:#fff}.cls-1,.cls-2{fill-rule:evenodd}.cls-3{fill:#069}.cls-1{fill:#000;fillrule:evenodd}@media (prefers-color-scheme:dark){.cls-1{fill:#fff}}.cls-2{fill:#000}@media (prefers-color-scheme:dark){.cls-2{fill:#fff}}.svg-2{fill:#000}@media (prefers-color-scheme:dark){.svg-2{fill:#fff}}.cv{fill:#000}@media (prefers-color-scheme:dark){.cv{fill:#fff}}</style>
<link href="/_astro/_...slug_.66530ebd.css" rel="stylesheet" media="print" onload="this.media='all'"><noscript><link href="/_astro/_...slug_.66530ebd.css" rel="stylesheet"></noscript>
<script src="/_astro/hoisted.1a56ad47.js" type="module"></script>
<script src="/_astro/page.dbf96ae3.js" type="module"></script>
<script>!function(t,e,n,i){(i=t[e]=Object.assign(t[e]||{},{lib:"/~partytown/",debug:!1}))[n]=(i[n]||[]).concat(["dataLayer.push"])}(window,"partytown","forward"),function(t,e,n,i,a,r,o,d,s,c,p,l){function u(){l||(l=1,"/"==(o=(r.lib||"/~partytown/")+(r.debug?"debug/":""))[0]&&(s=e.querySelectorAll('script[type="text/partytown"]'),i!=t?i.dispatchEvent(new CustomEvent("pt1",{detail:t})):(d=setTimeout(f,1e4),e.addEventListener("pt0",h),a?w(1):n.serviceWorker?n.serviceWorker.register(o+(r.swPath||"partytown-sw.js"),{scope:o}).then(function(t){t.active?w():t.installing&&t.installing.addEventListener("statechange",function(t){"activated"==t.target.state&&w()})},console.error):f())))}function w(t){c=e.createElement(t?"script":"iframe"),t||(c.setAttribute("style","display:block;width:0;height:0;border:0;visibility:hidden"),c.setAttribute("aria-hidden",!0)),c.src=o+"partytown-"+(t?"atomics.js?v=0.8.0":"sandbox-sw.html?"+Date.now()),e.querySelector(r.sandboxParent||"body").appendChild(c)}function f(n,a){for(h(),i==t&&(r.forward||[]).map(function(e){delete t[e.split(".")[0]]}),n=0;n<s.length;n++)(a=e.createElement("script")).innerHTML=s[n].innerHTML,e.head.appendChild(a);c&&c.parentNode.removeChild(c)}function h(){clearTimeout(d)}r=t.partytown||{},i==t&&(r.forward||[]).map(function(e){p=t,e.split(".").map(function(e,n,i){p=p[i[n]]=n+1<i.length?"push"==i[n+1]?[]:p[i[n]]||{}:function(){(t._ptf=t._ptf||[]).push(i,arguments)}})}),"complete"==e.readyState?u():(t.addEventListener("DOMContentLoaded",u),t.addEventListener("load",u))}(window,document,navigator,top,window.crossOriginIsolated);</script></head><body><nav class="links" data-astro-cid-4ducenwb=""><a href="/" class="link" data-astro-cid-4ducenwb="" rel="prefetch">Home</a><a href="/projects" class="link" data-astro-cid-4ducenwb="" rel="prefetch">
Projects
</a><a href="/skills" class="link" data-astro-cid-4ducenwb="" rel="prefetch">
Skills
</a><a href="/blog" class="link" data-astro-cid-4ducenwb="" rel="prefetch">
Blog
</a><a href="/about" class="link" data-astro-cid-4ducenwb="" rel="prefetch">
About
</a></nav><div class="dark:hover:prose-a:text-blue-600 dark:prose-a:text-blue-400 hover:prose-a:text-blue-900 mx-auto prose prose-a:text-blue-600 prose-headings:text-black overflow-y-auto prose-li:marker:text-black text-black bg-zinc-100 border border-zinc-400 dark:bg-zinc-800 dark:prose-headings:text-white dark:prose-li:marker:text-white dark:text-white fixed hidden max-h-80 max-w-[10rem] maxwidth p-4 prose-h2:mb-2 prose-h2:mt-0 right-4 rounded-lg sidebar top-10 xl:block z-10"><div class="mb-2"></div><div class="-mt-2"><h2 class="mt-0">Contents</h2><ul class="-ml-7 mb-0"><li class="flex list-none mb-1 mt-0"><span class="-ml-2 -mt-[.3rem] mr-2 text-3xl">•</span><a href="#request-response-cycle" class="break-words min-w-0 dark:text-blue-400 text-blue-600 dark:hover:text-blue-600 hover:text-blue-900">Request Response Cycle</a></li><li class="flex list-none mb-1 mt-0"><span class="-ml-2 -mt-[.3rem] mr-2 text-3xl">•</span><a href="#sso-set-up" class="break-words min-w-0 dark:text-blue-400 text-blue-600 dark:hover:text-blue-600 hover:text-blue-900">SSO Set up</a></li><li class="flex list-none mb-1 mt-0"><span class="-ml-2 -mt-[.3rem] mr-2 text-3xl">•</span><a href="#nextauth" class="break-words min-w-0 dark:text-blue-400 text-blue-600 dark:hover:text-blue-600 hover:text-blue-900">NextAuth</a></li><li class="flex list-none mb-1 mt-0"><span class="-ml-2 -mt-[.3rem] mr-2 text-3xl">•</span><a href="#drf" class="break-words min-w-0 dark:text-blue-400 text-blue-600 dark:hover:text-blue-600 hover:text-blue-900">DRF</a></li><li class="flex list-none mb-1 mt-0"><span class="-ml-2 -mt-[.3rem] mr-2 text-3xl">•</span><a href="#resources" class="break-words min-w-0 dark:text-blue-400 text-blue-600 dark:hover:text-blue-600 hover:text-blue-900">Resources</a></li></ul></div></div><div class="flex bg-transparent bottom-0 fixed justify-end left-0 p-2 right-0 xl:hidden z-50"><button aria-label="Menu Button" class="dropdown dropdown-end dropdown-top text-left"><label class="border-zinc-400 bg-zinc-300 btn dark:bg-zinc-700 dark:border-zinc-800 hover:bg-zinc-400 hover:border-zinc-500 m-1" tabindex="0">Menu</label><ul class="break-words min-w-0 bg-zinc-300 bottombar dark:bg-zinc-700 dark:hover:prose-a:text-blue-600 dark:prose-a:text-blue-400 dark:prose-headings:text-zinc-100 dark:prose-li:marker:text-zinc-100 dark:text-zinc-100 dropdown-content hover:prose-a:text-blue-900 max-w-max menu mx-auto overflow-x-hidden overflow-y-auto p-2 prose prose-a:text-blue-600 prose-headings:text-black prose-li:marker:text-black pt-10 rounded-box shadow text-black z-[1]" tabindex="0"><div class="max-h-52"><h2 class="mb-1 -mt-5 ml-2">Contents</h2><div class="pb-2 w-48"><li class="flex list-none -mb-[.35rem] -mt-1 ml-2"><div class="-mb-[.35rem]"><span class="-mt-[.15rem] text-2xl">•</span><a href="#request-response-cycle" class="break-words min-w-0 dark:text-blue-400 text-blue-600 link">Request Response Cycle</a></div></li><li class="flex list-none -mb-[.35rem] -mt-1 ml-2"><div class="-mb-[.35rem]"><span class="-mt-[.15rem] text-2xl">•</span><a href="#sso-set-up" class="break-words min-w-0 dark:text-blue-400 text-blue-600 link">SSO Set up</a></div></li><li class="flex list-none -mb-[.35rem] -mt-1 ml-2"><div class="-mb-[.35rem]"><span class="-mt-[.15rem] text-2xl">•</span><a href="#nextauth" class="break-words min-w-0 dark:text-blue-400 text-blue-600 link">NextAuth</a></div></li><li class="flex list-none -mb-[.35rem] -mt-1 ml-2"><div class="-mb-[.35rem]"><span class="-mt-[.15rem] text-2xl">•</span><a href="#drf" class="break-words min-w-0 dark:text-blue-400 text-blue-600 link">DRF</a></div></li><li class="flex list-none -mb-[.35rem] -mt-1 ml-2"><div class="-mb-[.35rem]"><span class="-mt-[.15rem] text-2xl">•</span><a href="#resources" class="break-words min-w-0 dark:text-blue-400 text-blue-600 link">Resources</a></div></li></div></div></ul></button></div><article class="break-words dark:hover:prose-a:text-blue-600 dark:prose-a:text-blue-400 dark:prose-li:marker:text-zinc-100 dark:text-zinc-100 hover:prose-a:text-blue-900 mx-auto prose prose-a:text-blue-600 prose-headings:text-black dark:prose-blockquote:bg-zinc-900 dark:prose-blockquote:text-zinc-100 dark:prose-code:bg-zinc-400 dark:prose-headings:text-zinc-50 dark:prose-strong:text-zinc-100 h-full lg:prose-xl md:prose-lg min-h-screen p-4 pb-14 prose-blockquote:bg-zinc-300 prose-blockquote:rounded-lg prose-blockquote:text-zinc-950 prose-code:bg-zinc-300 prose-code:rounded-md prose-code:text-black prose-li:marker:text-zinc-950 prose-li:my-0 prose-pre: prose-strong:text-zinc-950 prose-zinc text-zinc-950" data-astro-cid-7jjqptxk=""><h1 id="nextauth-social-sign-on-sso-with-django-rest-framework-drf">NextAuth Social Sign On (SSO) with Django REST Framework (DRF)<a href="#nextauth-social-sign-on-sso-with-django-rest-framework-drf" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled NextAuth Social Sign On (SSO) with Django REST Framework (DRF)</span></a></h1>
<p>This blog will outline and explain the steps for accomplishing:</p>
<ul>
<li>SSO for NextJS frontend using NextAuth</li>
<li>Authenticated and Authorized endpoints in DRF using Token Authentication</li>
</ul>
<p>TLDR: The trick is to use the SignIn callback to send the <code>idToken</code> from SSO provider to the DRF backend, and have the DRF backend validate the token then create a token (or new account and token) that can be used to authenticate future requests to the DRF endpoints.</p>
<h2 id="request-response-cycle">Request Response Cycle<a href="#request-response-cycle" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled Request Response Cycle</span></a></h2>
<ol>
<li>Frontend will send a reques to NextAuth Login API.</li>
<li>NextAuth Login API will request a token from the SSO Server. This is the first step in Authentication.</li>
<li>NextAuth API will send that token to DRF Server.</li>
<li>DRF Server will validate that token with SSO Server. This is the second step in Authentication, basically verification of authentication.</li>
<li>DRF Server will either create a new account and token for that user or regenerate the token of that user and send it back to NextAuth API - any other information from the user can also be sent back and included in the resulting login session at this time.</li>
<li>NextAuth will create a session which persists in the clients browser via a cookie (which cannot be accessed by javascript running in browser).</li>
<li>useSession hook will be availble throughout the NextJS project to allow access to session information. This session will contain the Authentication Token which will be used to Authenticate the user when they make requests to the backend.</li>
</ol>
<p><img alt="NextAuth SSO Provider DRF image" decoding="async" height="388" loading="lazy" src="/_astro/NA-DRF-RRC.bd0c4d87_EnG4t.webp.webp" width="946"></p>
<h2 id="sso-set-up">SSO Set up<a href="#sso-set-up" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled SSO Set up</span></a></h2>
<p>In this example Google OAuth2 will be used, but any service that provides social sign on will work the same.</p>
<p>First acquire a client ID and secret from the provider, then configure the allowed origins and callback URLs with the SSO provider.</p>
<p><a href="https://next-auth.js.org/configuration/callbacks#redirect-callback">NextAuth Callback URL Docs</a></p>
<h2 id="nextauth">NextAuth<a href="#nextauth" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled NextAuth</span></a></h2>
<p>Our NextJS project needs to create a NextAuth API which is as simple as creating a <code>pages/api/auth/[...nextauth].js</code> file with the following source code:</p>
<h3 id="nextauth-code">NextAuth code<a href="#nextauth-code" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled NextAuth code</span></a></h3>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> NextAuth </span><span style="color:#f97583">from</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">"next-auth"</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> GoogleProvider </span><span style="color:#f97583">from</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">"next-auth/providers/google"</span><span style="color:#e1e4e8">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">export</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">default</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">NextAuth</span><span style="color:#e1e4e8">({</span></span>
<span class="line"><span style="color:#e1e4e8">  providers: [</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#b392f0">GoogleProvider</span><span style="color:#e1e4e8">({</span></span>
<span class="line"><span style="color:#e1e4e8">      clientId: process.env.</span><span style="color:#79b8ff">NEXT_PUBLIC_OAUTH_CLIENT</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#e1e4e8">      clientSecret: process.env.</span><span style="color:#79b8ff">NEXT_PUBLIC_OAUTH_SECRET</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#e1e4e8">    }),</span></span>
<span class="line"><span style="color:#e1e4e8">  ],</span></span>
<span class="line"><span style="color:#e1e4e8">  secret: process.env.</span><span style="color:#79b8ff">NEXTAUTH_SECRET</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#e1e4e8">  session: {</span></span>
<span class="line"><span style="color:#e1e4e8">    maxAge: </span><span style="color:#79b8ff">24</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">*</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">60</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">*</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">60</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#e1e4e8">  },</span></span>
<span class="line"><span style="color:#e1e4e8">  callbacks: {</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">async</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">signIn</span><span style="color:#e1e4e8">({ </span><span style="color:#ffab70">user</span><span style="color:#e1e4e8">, </span><span style="color:#ffab70">account</span><span style="color:#e1e4e8"> }) {</span></span>
<span class="line"><span style="color:#e1e4e8">      </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> (user) {</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">const</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">idToken</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> account.id_token;</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">try</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">          </span><span style="color:#f97583">await</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">fetch</span><span style="color:#e1e4e8">(</span><span style="color:#9ecbff">`${</span><span style="color:#e1e4e8">process</span><span style="color:#9ecbff">.</span><span style="color:#e1e4e8">env</span><span style="color:#9ecbff">.</span><span style="color:#79b8ff">NEXT_PUBLIC_LOGIN_URL</span><span style="color:#9ecbff">}`</span><span style="color:#e1e4e8">, {</span></span>
<span class="line"><span style="color:#e1e4e8">            method: </span><span style="color:#9ecbff">"post"</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#e1e4e8">            headers: { </span><span style="color:#9ecbff">"Content-Type"</span><span style="color:#e1e4e8">: </span><span style="color:#9ecbff">"application/json"</span><span style="color:#e1e4e8"> },</span></span>
<span class="line"><span style="color:#e1e4e8">            body: </span><span style="color:#79b8ff">JSON</span><span style="color:#e1e4e8">.</span><span style="color:#b392f0">stringify</span><span style="color:#e1e4e8">({</span></span>
<span class="line"><span style="color:#e1e4e8">              auth_token: idToken,</span></span>
<span class="line"><span style="color:#e1e4e8">            }),</span></span>
<span class="line"><span style="color:#e1e4e8">          })</span></span>
<span class="line"><span style="color:#e1e4e8">            .</span><span style="color:#b392f0">then</span><span style="color:#e1e4e8">((</span><span style="color:#ffab70">response</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">=&gt;</span><span style="color:#e1e4e8"> response.</span><span style="color:#b392f0">json</span><span style="color:#e1e4e8">())</span></span>
<span class="line"><span style="color:#e1e4e8">            .</span><span style="color:#b392f0">then</span><span style="color:#e1e4e8">((</span><span style="color:#ffab70">data</span><span style="color:#e1e4e8">) </span><span style="color:#f97583">=&gt;</span><span style="color:#e1e4e8"> (user.auth_token </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> data));</span></span>
<span class="line"><span style="color:#e1e4e8">          </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">true</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">        } </span><span style="color:#f97583">catch</span><span style="color:#e1e4e8"> (error) {</span></span>
<span class="line"><span style="color:#e1e4e8">          </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">false</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span>
<span class="line"><span style="color:#e1e4e8">      }</span></span>
<span class="line"><span style="color:#e1e4e8">    },</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">async</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">jwt</span><span style="color:#e1e4e8">({ </span><span style="color:#ffab70">token</span><span style="color:#e1e4e8">, </span><span style="color:#ffab70">user</span><span style="color:#e1e4e8"> }) {</span></span>
<span class="line"><span style="color:#e1e4e8">      </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> (user) {</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">const</span><span style="color:#e1e4e8"> { </span><span style="color:#79b8ff">auth_token</span><span style="color:#e1e4e8"> } </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> user;</span></span>
<span class="line"><span style="color:#e1e4e8">        token.auth_token </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> auth_token;</span></span>
<span class="line"><span style="color:#e1e4e8">      }</span></span>
<span class="line"><span style="color:#e1e4e8">      </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> token;</span></span>
<span class="line"><span style="color:#e1e4e8">    },</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">async</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">session</span><span style="color:#e1e4e8">({ </span><span style="color:#ffab70">session</span><span style="color:#e1e4e8">, </span><span style="color:#ffab70">token</span><span style="color:#e1e4e8"> }) {</span></span>
<span class="line"><span style="color:#e1e4e8">      </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> (token.auth_token) {</span></span>
<span class="line"><span style="color:#e1e4e8">        session.auth_token </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> token.auth_token;</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> session;</span></span>
<span class="line"><span style="color:#e1e4e8">      }</span></span>
<span class="line"><span style="color:#e1e4e8">    },</span></span>
<span class="line"><span style="color:#e1e4e8">  },</span></span>
<span class="line"><span style="color:#e1e4e8">});</span></span></code></pre>
<h3 id="nextauth-code-explained">NextAuth code explained<a href="#nextauth-code-explained" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled NextAuth code explained</span></a></h3>
<p>NextAuth has builtin providers for all SSO providers, here we are using the GoogleProvider.</p>
<p>This code starts off by setting the secret from an environmental variable, then the session settings are configured.</p>
<p><code>maxAge</code> determines how long the session will be valid, which means how long until the user will need to sign in again.</p>
<h4 id="callback-functions">Callback functions<a href="#callback-functions" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled Callback functions</span></a></h4>
<p>The <code>signIn</code> callback is invoked when the user is authenticated by the SSO provider.</p>
<p>In this configuration the <code>signIn</code> callback will make a POST request to the DRF server. The body of the POST request will be our <code>idToken</code> (which is received from the SSO provider).</p>
<p>The <code>jwt</code> callback is invoked when the the signIn callback returns true.</p>
<p>This is where we can define what information will be stored in the JWT, which is stored in the Session Cookie. In this configuration we include the <code>auth_token</code> that is sent by the DRF Server which will later be used as an API key to make authenticated requests to the DRF server.</p>
<p>The <code>session</code> callback is invoked after the jwt callback signs and encrypts the jwt</p>
<p>This is when <code>auth_token</code> gets added into the session object. After the session callback completes the session is created and the user is returned to the frontend.</p>
<h3 id="making-calls-to-the-protected-drf-endpoints">Making calls to the protected DRF endpoints<a href="#making-calls-to-the-protected-drf-endpoints" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled Making calls to the protected DRF endpoints</span></a></h3>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#f97583">import</span><span style="color:#e1e4e8"> { useSession } </span><span style="color:#f97583">from</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">"next-auth/react"</span><span style="color:#e1e4e8">;</span></span>
<span class="line"><span style="color:#f97583">const</span><span style="color:#e1e4e8"> { </span><span style="color:#ffab70">data</span><span style="color:#e1e4e8">: </span><span style="color:#79b8ff">session</span><span style="color:#e1e4e8"> } </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">useSession</span><span style="color:#e1e4e8">();</span></span></code></pre>
<p>These two lines of code give the frontend access to the <code>auth_token</code> that we need to use to communicate with the DRF server.</p>
<p>Any other data that you have added into the session (e.g. data from the <code>idToken</code> or sent from the DRF server) can also be accessed like this.</p>
<p>When making requests to the protected DRF endpoints use this header:</p>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#b392f0">headers</span><span style="color:#e1e4e8">: {</span></span>
<span class="line"><span style="color:#e1e4e8">  </span><span style="color:#b392f0">Authorization</span><span style="color:#e1e4e8">: </span><span style="color:#9ecbff">"Token "</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">+</span><span style="color:#e1e4e8"> auth_token,</span></span>
<span class="line"><span style="color:#e1e4e8">  </span><span style="color:#9ecbff">"Content-Type"</span><span style="color:#e1e4e8">: </span><span style="color:#9ecbff">"application/json"</span><span style="color:#e1e4e8">,</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span></code></pre>
<h2 id="drf">DRF<a href="#drf" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled DRF</span></a></h2>
<p>Our endpoints will be protected by <a href="https://www.django-rest-framework.org/api-guide/authentication/#tokenauthentication">Token Authorization</a>. The step up consists of adjusting the user model and creating 4 new files.</p>
<h3 id="drf-code">DRF Code<a href="#drf-code" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled DRF Code</span></a></h3>
<ol>
<li>The accounts model should have an Auth Provider attribute in case multiple providers are used</li>
</ol>
<ul>
<li><code>auth_provider = models.CharField(max_length=50)</code></li>
</ul>
<ol start="2">
<li><code>views.py</code> should have a SocialAuthView that does not require authorization</li>
</ol>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#b392f0">@permission_classes</span><span style="color:#e1e4e8">((AllowAny, ))</span></span>
<span class="line"><span style="color:#f97583">class</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">GoogleSocialAuthView</span><span style="color:#e1e4e8">(</span><span style="color:#b392f0">GenericAPIView</span><span style="color:#e1e4e8">):</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    serializer_class </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> GoogleSocialAuthSerializer</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">def</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">post</span><span style="color:#e1e4e8">(self, request):</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#9ecbff">"""</span></span>
<span class="line"><span style="color:#9ecbff">        POST with "auth_token"</span></span>
<span class="line"><span style="color:#9ecbff">        Send an idtoken as from google to get user information</span></span>
<span class="line"><span style="color:#9ecbff">        """</span></span>
<span class="line"><span style="color:#e1e4e8">        serializer </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">self</span><span style="color:#e1e4e8">.serializer_class(</span><span style="color:#ffab70">data</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">request.data)</span></span>
<span class="line"><span style="color:#e1e4e8">        serializer.is_valid(</span><span style="color:#ffab70">raise_exception</span><span style="color:#f97583">=</span><span style="color:#79b8ff">True</span><span style="color:#e1e4e8">)</span></span>
<span class="line"><span style="color:#e1e4e8">        data </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> ((serializer.validated_data)[</span><span style="color:#9ecbff">'auth_token'</span><span style="color:#e1e4e8">])</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> Response(data, </span><span style="color:#ffab70">status</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">status.</span><span style="color:#79b8ff">HTTP_200_OK</span><span style="color:#e1e4e8">)</span></span></code></pre>
<ol start="3">
<li><code>serializers.py</code> should have a SocialAuthSerializer that is used to validate the <code>idToken</code> that the NextAuth API sends</li>
</ol>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#f97583">class</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">GoogleSocialAuthSerializer</span><span style="color:#e1e4e8">(</span><span style="color:#b392f0">serializers</span><span style="color:#e1e4e8">.</span><span style="color:#b392f0">Serializer</span><span style="color:#e1e4e8">):</span></span>
<span class="line"><span style="color:#e1e4e8">    auth_token </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> serializers.CharField()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">def</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">validate_auth_token</span><span style="color:#e1e4e8">(self, auth_token):</span></span>
<span class="line"><span style="color:#e1e4e8">        user_data </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> google.Google.validate(auth_token)</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">try</span><span style="color:#e1e4e8">:</span></span>
<span class="line"><span style="color:#e1e4e8">            user_data[</span><span style="color:#9ecbff">'sub'</span><span style="color:#e1e4e8">]</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">except</span><span style="color:#e1e4e8">:</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#f97583">raise</span><span style="color:#e1e4e8"> serializers.ValidationError(</span></span>
<span class="line"><span style="color:#e1e4e8">                </span><span style="color:#9ecbff">'The token is invalid or expired. Please login again.'</span></span>
<span class="line"><span style="color:#e1e4e8">            )</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> user_data[</span><span style="color:#9ecbff">'aud'</span><span style="color:#e1e4e8">] </span><span style="color:#f97583">!=</span><span style="color:#e1e4e8"> settings.</span><span style="color:#79b8ff">GOOGLE_CLIENT_ID</span><span style="color:#e1e4e8">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#f97583">raise</span><span style="color:#e1e4e8"> AuthenticationFailed(</span><span style="color:#9ecbff">'oops, who are you?'</span><span style="color:#e1e4e8">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">        email </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> user_data[</span><span style="color:#9ecbff">'email'</span><span style="color:#e1e4e8">]</span></span>
<span class="line"><span style="color:#e1e4e8">        name </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> user_data[</span><span style="color:#9ecbff">'name'</span><span style="color:#e1e4e8">]</span></span>
<span class="line"><span style="color:#e1e4e8">        provider </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">'google'</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> register_social_user(</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#ffab70">provider</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">provider, </span><span style="color:#ffab70">email</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">email, </span><span style="color:#ffab70">name</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">name)</span></span></code></pre>
<ol start="4">
<li>This serializer will take import from the next file we need to create <code>google.py</code></li>
</ol>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> google.auth.transport </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> requests</span></span>
<span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> google.oauth2 </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> id_token</span></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">class</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">Google</span><span style="color:#e1e4e8">:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#b392f0">@</span><span style="color:#79b8ff">staticmethod</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">def</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">validate</span><span style="color:#e1e4e8">(auth_token):</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">try</span><span style="color:#e1e4e8">:</span></span>
<span class="line"><span style="color:#e1e4e8">            idinfo </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> id_token.verify_oauth2_token(</span></span>
<span class="line"><span style="color:#e1e4e8">                auth_token, requests.Request())</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">'accounts.google.com'</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">in</span><span style="color:#e1e4e8"> idinfo[</span><span style="color:#9ecbff">'iss'</span><span style="color:#e1e4e8">]:</span></span>
<span class="line"><span style="color:#e1e4e8">                </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> idinfo</span></span>
<span class="line"></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">except</span><span style="color:#e1e4e8">:</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">"The token is either invalid or has expired"</span></span></code></pre>
<ol start="5">
<li>Next we need to create <code>register.py</code></li>
</ol>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> rest_framework.authtoken.models </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> Token</span></span>
<span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> default_locations.models </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> DefaultLocation</span></span>
<span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> accounts.models </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> User</span></span>
<span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> django.conf </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> settings</span></span>
<span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> rest_framework.exceptions </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> AuthenticationFailed</span></span>
<span class="line"><span style="color:#f97583">from</span><span style="color:#e1e4e8"> django.core.exceptions </span><span style="color:#f97583">import</span><span style="color:#e1e4e8"> ObjectDoesNotExist</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#f97583">def</span><span style="color:#e1e4e8"> </span><span style="color:#b392f0">register_social_user</span><span style="color:#e1e4e8">(provider, email, name):</span></span>
<span class="line"><span style="color:#e1e4e8">    filtered_user_by_email </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> User.objects.filter(</span><span style="color:#ffab70">username</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">email)</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> filtered_user_by_email.exists():</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">if</span><span style="color:#e1e4e8"> provider </span><span style="color:#f97583">==</span><span style="color:#e1e4e8"> filtered_user_by_email[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">].auth_provider:</span></span>
<span class="line"><span style="color:#e1e4e8">            registered_user </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> User.objects.get(</span><span style="color:#ffab70">username</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">email)</span></span>
<span class="line"><span style="color:#e1e4e8">            registered_user.check_password(settings.</span><span style="color:#79b8ff">SOCIAL_SECRET</span><span style="color:#e1e4e8">)</span></span>
<span class="line"><span style="color:#e1e4e8">            Token.objects.filter(</span><span style="color:#ffab70">user</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">registered_user).delete()</span></span>
<span class="line"><span style="color:#e1e4e8">            Token.objects.create(</span><span style="color:#ffab70">user</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">registered_user)</span></span>
<span class="line"><span style="color:#e1e4e8">            new_token </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">list</span><span style="color:#e1e4e8">(Token.objects.filter(</span></span>
<span class="line"><span style="color:#e1e4e8">                </span><span style="color:#ffab70">user_id</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">registered_user).values(</span><span style="color:#9ecbff">"key"</span><span style="color:#e1e4e8">))</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">                </span><span style="color:#9ecbff">'user_id'</span><span style="color:#e1e4e8">: registered_user.id,</span></span>
<span class="line"><span style="color:#e1e4e8">                </span><span style="color:#9ecbff">'tokens'</span><span style="color:#e1e4e8">: </span><span style="color:#79b8ff">str</span><span style="color:#e1e4e8">(new_token[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">][</span><span style="color:#9ecbff">'key'</span><span style="color:#e1e4e8">])}</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">else</span><span style="color:#e1e4e8">:</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#f97583">raise</span><span style="color:#e1e4e8"> AuthenticationFailed(</span></span>
<span class="line"><span style="color:#e1e4e8">                </span><span style="color:#ffab70">detail</span><span style="color:#f97583">=</span><span style="color:#9ecbff">'Login using '</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">+</span><span style="color:#e1e4e8"> filtered_user_by_email[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">].auth_provider)</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#f97583">else</span><span style="color:#e1e4e8">:</span></span>
<span class="line"><span style="color:#e1e4e8">        user </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#9ecbff">'username'</span><span style="color:#e1e4e8">: email,</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#9ecbff">'password'</span><span style="color:#e1e4e8">: settings.</span><span style="color:#79b8ff">SOCIAL_SECRET</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span>
<span class="line"><span style="color:#e1e4e8">        user </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> User.objects.create_user(</span><span style="color:#f97583">**</span><span style="color:#e1e4e8">user)</span></span>
<span class="line"><span style="color:#e1e4e8">        user.is_active </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">True</span></span>
<span class="line"><span style="color:#e1e4e8">        user.auth_provider </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> provider</span></span>
<span class="line"><span style="color:#e1e4e8">        user.save()</span></span>
<span class="line"><span style="color:#e1e4e8">        new_user </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> User.objects.get(</span><span style="color:#ffab70">username</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">email)</span></span>
<span class="line"><span style="color:#e1e4e8">        new_user.check_password(settings.</span><span style="color:#79b8ff">SOCIAL_SECRET</span><span style="color:#e1e4e8">)</span></span>
<span class="line"><span style="color:#e1e4e8">        Token.objects.create(</span><span style="color:#ffab70">user</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">new_user)</span></span>
<span class="line"><span style="color:#e1e4e8">        new_token </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#79b8ff">list</span><span style="color:#e1e4e8">(Token.objects.filter(</span><span style="color:#ffab70">user_id</span><span style="color:#f97583">=</span><span style="color:#e1e4e8">new_user).values(</span><span style="color:#9ecbff">"key"</span><span style="color:#e1e4e8">))</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#f97583">return</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#9ecbff">'user_id'</span><span style="color:#e1e4e8">: new_user.id,</span></span>
<span class="line"><span style="color:#e1e4e8">            </span><span style="color:#9ecbff">'tokens'</span><span style="color:#e1e4e8">: </span><span style="color:#79b8ff">str</span><span style="color:#e1e4e8">(new_token[</span><span style="color:#79b8ff">0</span><span style="color:#e1e4e8">][</span><span style="color:#9ecbff">'key'</span><span style="color:#e1e4e8">]),</span></span>
<span class="line"><span style="color:#e1e4e8">        }</span></span></code></pre>
<h3 id="drf-code-explained">DRF Code Explained<a href="#drf-code-explained" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled DRF Code Explained</span></a></h3>
<ol>
<li>
<p>The user model needs to keep track of the auth_provider so that multiple SSO providers can be implemented</p>
<ul>
<li>This allows for Sign in with Google, Sign in with Facebook, Sign in with Github, etc…</li>
</ul>
</li>
<li>
<p>Creating a view for each SSO creates an endpoint that NextAuth will request during the <code>signIn</code> callback</p>
</li>
<li>
<p>Creating a serializer for each endpoint allows for the <code>idToken</code> sent by that endpoint to be validated</p>
<ul>
<li>This is where one would make a query for other data in the DRF’s database that they might send back to be included in the frontend’s session data</li>
</ul>
</li>
<li>
<p>Creating <code>google.py</code> as a seperate file is not strictly necessary but this allows for more readable code in my opinion</p>
<ul>
<li>this function is what actually contacts the SSO provider and validates the token</li>
</ul>
</li>
<li>
<p><code>register.py</code>  is where the users and tokens are generated</p>
<ul>
<li>if the user already exists their existing token is deleted and a new one is created for them</li>
<li>if the user does not exist a token and a new user is created</li>
</ul>
</li>
</ol>
<p>The DRF server needs to expose an unauthorized endpoint that accepts an <code>idToken</code>, validate that token with the provider and if the token is valid it needs to create an Authorization Token, and a new user if that <code>idToken</code> has not already been used by an existing account.</p>
<h3 id="requiring-authorization-for-other-drf-endpoints">Requiring Authorization for other DRF endpoints<a href="#requiring-authorization-for-other-drf-endpoints" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled Requiring Authorization for other DRF endpoints</span></a></h3>
<ol>
<li>
<p>Add <code>permission_classes = (IsAuthenticated,)</code> with the <code>rest_framework.permissions import IsAuthenticated</code> function to all endpoints</p>
<ul>
<li>it is possible to set permission classes with decorators as well</li>
<li><code>@permission_classes( [IsAuthenticated], )</code></li>
<li><a href="https://www.django-rest-framework.org/api-guide/permissions/">DRF permissions docs</a></li>
</ul>
</li>
<li>
<p>Place these settings in the <code>settings.py</code> file of the main portion of the Django project</p>
</li>
</ol>
<pre class="astro-code github-dark" is:raw="" tabindex="0"><code><span class="line"><span style="color:#79b8ff">AUTH_USER_MODEL</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> </span><span style="color:#9ecbff">"accounts.User"</span></span>
<span class="line"><span style="color:#79b8ff">REST_FRAMEWORK</span><span style="color:#e1e4e8"> </span><span style="color:#f97583">=</span><span style="color:#e1e4e8"> {</span></span>
<span class="line"><span style="color:#e1e4e8">    </span><span style="color:#9ecbff">'DEFAULT_AUTHENTICATION_CLASSES'</span><span style="color:#e1e4e8">: [</span></span>
<span class="line"><span style="color:#e1e4e8">        </span><span style="color:#9ecbff">'rest_framework.authentication.TokenAuthentication'</span><span style="color:#e1e4e8">, </span></span>
<span class="line"><span style="color:#e1e4e8">    ],</span></span>
<span class="line"><span style="color:#e1e4e8">}</span></span></code></pre>
<ol start="3">
<li>This is all that is required for the endpoints to refuse access when in invalid token is not sent to them and accept when a valid token is sent</li>
<li>The endpoints will now have <code>self.request.user</code> availble to them</li>
</ol>
<h2 id="resources">Resources<a href="#resources" class="anchor-link"><span class="anchor-icon" aria-hidden="true"><svg viewBox="0 0 16 16" height="16" version="1.1" width="16" xlmns="http://www.w3.org/2000/svg"><path d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z" fill="currentcolor" fill-rule="evenodd"></path></svg></span><span class="sr-only" is:raw="">Section titled Resources</span></a></h2>
<ul>
<li><a href="https://github.com/orgs/Oxygen-Oriented-Programming/repositories">Project I used this code for</a>
<ul>
<li><a href="https://github.com/Oxygen-Oriented-Programming/Clean-Air-Compass-Frontend-NextJS/blob/dev/pages/api/auth/%5B...nextauth%5D.js">NextAuth file of the project</a></li>
<li><a href="https://github.com/Oxygen-Oriented-Programming/Clean-Air-Compass-Accounts-DjangoRestFramework/tree/dev/accounts">DRF Accounts app of the project</a></li>
</ul>
</li>
<li><a href="https://www.django-rest-framework.org/api-guide/authentication/#tokenauthentication">Token Authentication</a></li>
<li><a href="https://next-auth.js.org/configuration/initialization">NextAuth Docs</a></li>
<li><a href="https://github.com/nextauthjs/next-auth/discussions/1350">GitHub Discussion about NextAuth and DRF</a></li>
<li><a href="https://mahieyin-rahmun.medium.com/how-to-configure-social-authentication-in-a-next-js-next-auth-django-rest-framework-application-cb4c82be137">Article by Mahieyin Rahmun</a> and its <a href="https://mahieyin-rahmun.medium.com/how-to-configure-social-authentication-in-a-next-js-next-auth-django-rest-framework-application-cb4c82be137">second part</a></li>
<li><a href="https://episyche.com/blog/how-to-configure-google-sso-in-django-rest-framework-with-nextjs">Article by Episyche</a> used for <code>register.py</code>, <code>google.py</code> and <code>serializers.py</code></li>
</ul></article><footer class="projects" data-astro-cid-bpcqfiqj=""><a href="https://www.linkedin.com/in/oliverspeir/" class="tooltip" aria-label="Click to view my LinkedIn profile" data-astro-cid-bpcqfiqj="" data-tooltip="Click to view my LinkedIn profile" target="_blank"><svg viewBox="0 0 87.28 76.25" data-astro-cid-bpcqfiqj="" id="svg3070" xmlns="http://www.w3.org/2000/svg"><g data-astro-cid-bpcqfiqj="" id="layer1"><g data-astro-cid-bpcqfiqj="" id="g3019"><path d="M11.51,5.46c0-3.02,2.51-5.46,5.6-5.46H81.68c3.09,0,5.6,2.45,5.6,5.46V70.79c0,3.02-2.51,5.46-5.6,5.46H17.11c-3.09,0-5.6-2.45-5.6-5.46V5.46Z" class="cls-3" data-astro-cid-bpcqfiqj="" id="path14"></path><path d="M0,13.88,.3,63.87" class="cls-2" data-astro-cid-bpcqfiqj="" id="path26"></path><path d="M34.48,63.83V29.4h-11.44V63.83h11.44Zm-5.72-39.13c3.99,0,6.47-2.64,6.47-5.95-.07-3.38-2.48-5.95-6.4-5.95s-6.47,2.57-6.47,5.95,2.48,5.95,6.32,5.95h.07Z" class="cls-1" data-astro-cid-bpcqfiqj="" id="path28"></path><path d="M40.81,63.83h11.44v-19.23c0-1.03,.07-2.06,.38-2.79,.83-2.06,2.71-4.19,5.87-4.19,4.14,0,5.8,3.16,5.8,7.79v18.42h11.44v-19.74c0-10.58-5.65-15.5-13.18-15.5-6.17,0-8.88,3.45-10.39,5.8h.08v-4.99h-11.44c.15,3.23,0,34.43,0,34.43h0Z" class="cls-1" data-astro-cid-bpcqfiqj="" id="path30"></path></g></g></svg></a><a href="https://github.com/OliverSpeir" class="tooltip" aria-label="Click to view my GitHub profile" data-astro-cid-bpcqfiqj="" data-tooltip="Click to view my GitHub profile" target="_blank"><svg viewBox="0 0 195.25 192" data-astro-cid-bpcqfiqj="" id="Layer_1" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><path d="M97.71,0C43.68,0,0,44,0,98.43c0,43.51,27.99,80.34,66.81,93.38,4.85,.98,6.63-2.12,6.63-4.72,0-2.28-.16-10.1-.16-18.25-27.18,5.87-32.84-11.73-32.84-11.73-4.37-11.41-10.84-14.34-10.84-14.34-8.9-6.03,.65-6.03,.65-6.03,9.87,.65,15.05,10.1,15.05,10.1,8.73,14.99,22.81,10.76,28.47,8.15,.81-6.36,3.4-10.76,6.15-13.2-21.68-2.28-44.49-10.76-44.49-48.57,0-10.76,3.88-19.56,10.03-26.4-.97-2.44-4.37-12.55,.97-26.08,0,0,8.25-2.61,26.85,10.1,7.96-2.15,16.18-3.25,24.43-3.26,8.25,0,16.66,1.14,24.43,3.26,18.6-12.71,26.85-10.1,26.85-10.1,5.34,13.53,1.94,23.63,.97,26.08,6.31,6.84,10.03,15.64,10.03,26.4,0,37.81-22.81,46.12-44.65,48.57,3.56,3.1,6.63,8.96,6.63,18.25,0,13.2-.16,23.79-.16,27.05,0,2.61,1.78,5.71,6.63,4.73,38.82-13.04,66.81-49.87,66.81-93.38C195.41,44,151.58,0,97.71,0Z" class="cls-1" data-astro-cid-bpcqfiqj=""></path><g data-astro-cid-bpcqfiqj=""><path d="M69.95,94.25h-7.57c-.2,0-.35,.16-.35,.35v3.7c0,.2,.16,.35,.35,.35h2.95v4.6s-.66,.23-2.5,.23c-2.16,0-5.18-.79-5.18-7.43s3.14-7.52,6.1-7.52c2.56,0,3.66,.45,4.36,.67,.22,.07,.42-.15,.42-.35l.84-3.57c0-.09-.03-.2-.14-.28-.28-.2-2.02-1.17-6.41-1.17-5.05,0-10.23,2.15-10.23,12.48s5.93,11.87,10.93,11.87c4.14,0,6.65-1.77,6.65-1.77,.1-.06,.11-.2,.11-.27v-11.54c0-.2-.16-.35-.35-.35Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path><path d="M108.94,85.06c0-.2-.16-.36-.35-.36h-4.26c-.19,0-.35,.16-.35,.36,0,0,0,8.23,0,8.23h-6.64v-8.23c0-.2-.16-.36-.35-.36h-4.26c-.19,0-.35,.16-.35,.36v22.29c0,.2,.16,.36,.35,.36h4.26c.19,0,.35-.16,.35-.36v-9.54h6.64s-.01,9.54-.01,9.54c0,.2,.16,.36,.35,.36h4.27c.2,0,.35-.16,.35-.36v-22.29Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path><g data-astro-cid-bpcqfiqj=""><path d="M77.99,87.99c0-1.53-1.23-2.77-2.75-2.77s-2.75,1.24-2.75,2.77,1.23,2.78,2.75,2.78,2.75-1.24,2.75-2.78Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path><path d="M77.68,102.65v-10.29c0-.2-.16-.36-.35-.36h-4.25c-.19,0-.37,.2-.37,.4v14.74c0,.43,.27,.56,.62,.56h3.83c.42,0,.52-.21,.52-.57v-4.49Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path></g><path d="M125.14,92.04h-4.23c-.19,0-.35,.16-.35,.36v10.93s-1.07,.79-2.6,.79-1.93-.69-1.93-2.18v-9.53c0-.2-.16-.36-.35-.36h-4.29c-.19,0-.35,.16-.35,.36v10.25c0,4.43,2.47,5.52,5.87,5.52,2.79,0,5.04-1.54,5.04-1.54,0,0,.11,.81,.16,.91,.05,.1,.17,.19,.31,.19h2.73c.19-.01,.35-.17,.35-.37v-14.97c0-.2-.16-.36-.35-.36Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path><path d="M136.69,91.54c-2.4,0-4.03,1.07-4.03,1.07v-7.55c0-.2-.16-.36-.35-.36h-4.27c-.19,0-.35,.16-.35,.36v22.29c0,.2,.16,.36,.35,.36h2.96c.13,0,.23-.07,.31-.19,.07-.12,.18-1.03,.18-1.03,0,0,1.75,1.66,5.05,1.66,3.88,0,6.11-1.97,6.11-8.84s-3.56-7.77-5.96-7.77Zm-1.67,12.56c-1.47-.04-2.46-.71-2.46-.71v-7.06s.98-.6,2.19-.71c1.52-.14,2.99,.32,2.99,3.96,0,3.83-.66,4.59-2.71,4.52Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path><path d="M89.93,92.01h-3.2s0-4.22,0-4.22c0-.16-.08-.24-.27-.24h-4.36c-.17,0-.26,.07-.26,.24v4.36s-2.18,.53-2.33,.57c-.15,.04-.26,.18-.26,.34v2.74c0,.2,.16,.36,.35,.36h2.23v6.6c0,4.9,3.44,5.38,5.76,5.38,1.06,0,2.33-.34,2.54-.42,.13-.05,.2-.18,.2-.32v-3.02c0-.2-.16-.36-.35-.36s-.66,.08-1.15,.08c-1.57,0-2.1-.73-2.1-1.67s0-6.27,0-6.27h3.2c.19,0,.35-.16,.35-.36v-3.43c0-.2-.16-.36-.35-.36Z" class="cls-2" data-astro-cid-bpcqfiqj=""></path></g></svg></a><a href="mailto:oliverspeir9@gmail.com" class="tooltip" aria-label="Click to send me an email" data-astro-cid-bpcqfiqj="" data-tooltip="Click to send me an email" target="_blank"><svg viewBox="0 0 30 20" data-astro-cid-bpcqfiqj="" id="Layer_1" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><path d="M3,0C1.36,0,0,1.36,0,3v14c0,1.64,1.36,3,3,3H27c1.64,0,3-1.36,3-3V3c0-1.64-1.36-3-3-3H3Zm.41,2H26.58l-8.91,8.89c-1.49,1.49-3.88,1.49-5.37,0L3.41,2Zm24.59,1.41v13.18l-6.6-6.59,6.6-6.59ZM2,3.41l6.59,6.59-6.59,6.59V3.41ZM19.99,11.41l6.6,6.59H3.41l6.59-6.59,.89,.89c2.26,2.26,5.94,2.26,8.2,0l.9-.9h0Z" class="svg-2" data-astro-cid-bpcqfiqj=""></path></svg></a><div class="cv" data-astro-cid-bpcqfiqj=""><a href="/CV.pdf" class="tooltip" aria-label="Click to view my Resume/CV" data-astro-cid-bpcqfiqj="" data-tooltip="Click to view or download my CV" target="_blank"><svg viewBox="0 0 373.86 444.42" data-astro-cid-bpcqfiqj="" id="Layer_1" xmlns="http://www.w3.org/2000/svg" data-name="Layer 1"><path d="M156.52,95.59c0,19.77-16.02,35.79-35.79,35.79s-35.79-16.02-35.79-35.79,16.02-35.78,35.79-35.78,35.79,16.02,35.79,35.78" class="cv" data-astro-cid-bpcqfiqj=""></path><path d="M62.44,203.62h116.54c2.35,0,4.26-1.9,4.26-4.25v-2.58c-.02-14.7-5.86-28.79-16.25-39.18s-24.49-16.24-39.19-16.25h-14.17c-14.7,.02-28.79,5.86-39.18,16.25-10.4,10.4-16.24,24.48-16.25,39.18v2.58c0,2.35,1.9,4.25,4.25,4.25h0Z" class="cv" data-astro-cid-bpcqfiqj=""></path><path d="M373.86,67.2c0-17.82-7.08-34.91-19.68-47.52-12.6-12.6-29.7-19.68-47.52-19.68H67.2C49.38,0,32.29,7.08,19.68,19.68,7.08,32.28,0,49.38,0,67.2V377.22c0,17.82,7.08,34.91,19.68,47.52,12.6,12.6,29.7,19.68,47.52,19.68h239.45c17.82,0,34.92-7.08,47.52-19.68,12.6-12.61,19.68-29.7,19.68-47.52V67.2h.01Zm-22.4,309.96h0c0,11.88-4.72,23.28-13.12,31.68s-19.8,13.12-31.68,13.12H67.21c-11.88,0-23.28-4.72-31.68-13.12-8.4-8.4-13.12-19.8-13.12-31.68V67.2c0-11.88,4.72-23.28,13.12-31.68,8.4-8.4,19.8-13.12,31.68-13.12h239.45c11.88,0,23.28,4.72,31.68,13.12,8.4,8.4,13.12,19.8,13.12,31.68V377.16h0Z" class="cv" data-astro-cid-bpcqfiqj=""></path><path d="M313.77,102.87h-96.6c-6.18,0-11.2,5.02-11.2,11.2s5.02,11.2,11.2,11.2h96.6c6.19,0,11.2-5.01,11.2-11.2s-5.01-11.2-11.2-11.2Z" class="cv" data-astro-cid-bpcqfiqj=""></path><path d="M313.77,170.07h-96.6c-6.18,0-11.2,5.02-11.2,11.2s5.02,11.2,11.2,11.2h96.6c6.19,0,11.2-5.02,11.2-11.2s-5.01-11.2-11.2-11.2Z" class="cv" data-astro-cid-bpcqfiqj=""></path><path d="M313.77,270.87H65.97c-6.18,0-11.2,5.02-11.2,11.2s5.02,11.2,11.2,11.2h247.8c6.19,0,11.2-5.01,11.2-11.2s-5.01-11.2-11.2-11.2h0Z" class="cv" data-astro-cid-bpcqfiqj=""></path><path d="M313.77,338.07H65.97c-6.18,0-11.2,5.02-11.2,11.2s5.02,11.2,11.2,11.2h247.8c6.19,0,11.2-5.02,11.2-11.2s-5.01-11.2-11.2-11.2h0Z" class="cv" data-astro-cid-bpcqfiqj=""></path></svg></a></div></footer><div class="mb-16" data-astro-cid-7jjqptxk=""></div></body></html>